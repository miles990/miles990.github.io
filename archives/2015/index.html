<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives: 2015 | 世紀末程式猿</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="吱吱...">
<meta property="og:type" content="website">
<meta property="og:title" content="世紀末程式猿">
<meta property="og:url" content="http://miles990.github.io/archives/2015/">
<meta property="og:site_name" content="世紀末程式猿">
<meta property="og:description" content="吱吱...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="世紀末程式猿">
<meta name="twitter:description" content="吱吱...">

  
    <link rel="alternative" href="/atom.xml" title="世紀末程式猿" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">世紀末程式猿</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">這個世界最後只剩下猴子...</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://miles990.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-深入淺出Node-js讀書心得-二" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/23/深入淺出Node-js讀書心得-二/" class="article-date">
  <time datetime="2015-04-23T08:14:22.000Z" itemprop="datePublished">Apr 23 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深入淺出Node-js讀書心得/">深入淺出Node.js讀書心得</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/23/深入淺出Node-js讀書心得-二/">深入淺出Node.js讀書心得(二)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Chapter_2_:_模組機制"><a href="#">Chapter 2 : 模組機制</a></h1>
<h2 id="CommonJS的模組規範">CommonJS的模組規範</h2>
<ol>
<li>模組引用<br>EX:<br><code>var math = require(&#39;math&#39;);</code></li>
<li>模組定義</li>
<li>模組識別字</li>
</ol>
<h2 id="在_Node_引入模組時，需要經歷以下三個步驟:">在 Node 引入模組時，需要經歷以下三個步驟:</h2>
<ol>
<li>路徑分析</li>
<li>檔案定位</li>
<li>編譯執行</li>
</ol>
<h2 id="目錄分析與套件">目錄分析與套件</h2>
<p>Node 首先在當前目錄下找尋 package.json (CommonJS 套件規範定義的套件描述檔)，接著透過 JSON.parse() 解析套件描述物件，從中取出 main 屬性指定的檔案名稱進行定位。<br>假如 main 屬性指定的檔名錯誤，或者根本沒有 package.json 檔，Node 會把 index 當作預設的檔案，然後依序尋找 index.js、index.node、index.json。</p>
<h2 id="模組編譯">模組編譯</h2>
<p>編譯和執行是含括檔案模組的最後一個階段。定位實際的檔案後，Node 會新建一個模組物件，然後根據路徑載入並編譯。<br>針對不一樣的副檔名，載入方法也不盡相同，如下：</p>
<ul>
<li>.js 文件<br>透過 fs 模組同步讀取檔案後編譯</li>
<li>.node 文件<br>這是用 C/C++ 編寫的擴充檔，透過 dlopen() 方法載入最後編譯而成的檔案</li>
<li>.json 文件<br>透過 fs 模組同步讀取檔案後，再以 JSON.parse() 解析返回結果</li>
<li>其餘副檔名的文件<br>都被當成 .js 文件載入</li>
</ul>
<h2 id="套件與NPM">套件與NPM</h2>
<h4 id="完全符合CommonJS規範的套件目錄應該包含以下檔案">完全符合CommonJS規範的套件目錄應該包含以下檔案</h4>
<ul>
<li>package.json：套件描述檔</li>
<li>bin：存放可執行二進位檔的目錄</li>
<li>lib：存放 JavaScript 程式碼的目錄</li>
<li>doc：存放文件的目錄</li>
<li>test：存放單元測試案例的程式碼</li>
</ul>
<h4 id="在套件描述檔_(package-json)_的規範中，NPM_實際需要的欄位主要有">在套件描述檔 (package.json) 的規範中，NPM 實際需要的欄位主要有</h4>
<ul>
<li>name</li>
<li>version</li>
<li>description</li>
<li>keywords</li>
<li>repositories</li>
<li>author</li>
<li>bin</li>
<li>main</li>
<li>scripts</li>
<li>engines</li>
<li>dependencies</li>
<li>devDependencies</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/04/23/深入淺出Node-js讀書心得-二/" data-id="6szt7jr98gply899" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/04/23/深入淺出Node-js讀書心得-二/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/深入淺出Node-js讀書心得-二/">深入淺出Node.js讀書心得(二)</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/讀書心得/">讀書心得</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-深入淺出Node-js讀書心得-ㄧ" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/23/深入淺出Node-js讀書心得-ㄧ/" class="article-date">
  <time datetime="2015-04-23T07:00:50.000Z" itemprop="datePublished">Apr 23 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深入淺出Node-js讀書心得/">深入淺出Node.js讀書心得</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/23/深入淺出Node-js讀書心得-ㄧ/">深入淺出Node.js讀書心得(ㄧ)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Chapter_1_:_Node_簡介"><a href="#">Chapter 1 : Node 簡介</a></h1>
<h2 id="Node的特點:">Node的特點:</h2>
<ul>
<li><strong>非同步 (Asynchronous) I/O</strong></li>
<li><strong>事件 (Events) 與回呼函數 (Callback functions)</strong></li>
<li><strong>單執行緒 (Single thread)</strong><ul>
<li>優點：<ol>
<li>不用像多執行緒那般處處在意狀態的同步問題</li>
<li>不會有鎖死 (deadlock) 的情況</li>
<li>沒有執行緒上下文交換 (content switch) 時帶來的額外性能代價</li>
</ol>
</li>
<li>缺點：<ol>
<li>無法利用多核 CPU</li>
<li>錯誤會引起整個應用程式退出 (crash?)，值得一再考驗其健壯性</li>
<li>大量計算佔用 CPU，導致無法繼續呼叫非同步 I/O<font color="red"><br><code>Node 採用和 Html5 的 Web Workers 相同概念來解決單執行緒中大量計算的問題：child_process</code><br></font></li>
</ol>
</li>
</ul>
</li>
<li><strong>跨平台</strong></li>
</ul>
<h2 id="Node的應用場景">Node的應用場景</h2>
<ul>
<li>I/O 密集型</li>
<li>是否不擅長 CPU 密集型<font color="red"><br><code>適當調整和分解大型運算為多個小任務，便能讓運算適時釋放，不阻塞 I/O 呼叫的啟動，這樣既可同時享受並行非同步 I/O 的好處，又能充分利用 CPU。</code><br></font></li>
<li>與就有系統和平共存</li>
<li>分散式應用</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/04/23/深入淺出Node-js讀書心得-ㄧ/" data-id="76xsddiavli8geum" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/04/23/深入淺出Node-js讀書心得-ㄧ/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/深入淺出Node-js讀書心得-一/">深入淺出Node.js讀書心得(一)</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/讀書心得/">讀書心得</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Node-js讀書會" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/18/Node-js讀書會/" class="article-date">
  <time datetime="2015-04-18T08:19:16.000Z" itemprop="datePublished">Apr 18 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深入淺出Node-js讀書心得/">深入淺出Node.js讀書心得</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/18/Node-js讀書會/">Node.js讀書會</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>因緣際會在 Facebook 上看到一個 Node.js 讀書會的活動。<br>他們挑了這一本書。</p>
<p><img src="http://d2hsbzg80yxel6.cloudfront.net/images/85173/medium/PG21433.jpg" alt="深入淺出Node.js"><br><a href="http://www.tenlong.com.tw/items/9862019409?item_id=997343" target="_blank" rel="external">深入淺出Node.js</a>，這本在天瓏書局找得到。</p>
<p>大概翻了一下，有一點深度。<br>適合有一點程式基礎，剛接觸 Node.js，想要深入了解 Node.js的底層運作方式的人。</p>
<p>之後會把看書的一些心得或重點記錄在這裡。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/04/18/Node-js讀書會/" data-id="vpx4egsgl70pbj09" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/04/18/Node-js讀書會/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/讀書會/">讀書會</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Mongodb-s-Replica-Set-Sharded-Cluster" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/03/24/Mongodb-s-Replica-Set-Sharded-Cluster/" class="article-date">
  <time datetime="2015-03-24T07:29:30.000Z" itemprop="datePublished">Mar 24 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MongoDB-學習筆記/">MongoDB 學習筆記</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/24/Mongodb-s-Replica-Set-Sharded-Cluster/">Mongodb&#39;s Replica Set &amp; Sharded Cluster</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="MongoDB_Replication"><a href="http://docs.mongodb.org/manual/replication/" target="_blank" rel="external">MongoDB Replication</a></h2>
<p><img src="http://docs.mongodb.org/manual/_images/replica-set-read-write-operations-primary.png" alt="Primary 接受所有從client傳來的寫入操作"></p>
<p><strong>Primary</strong> 接受所有從client傳來的寫入操作</p>
<p><strong>Replica set</strong> (副本集) 只會有一個 <strong>Primary</strong>，因為只有一個成員接受寫入操作。副本集提供嚴格的一致性，對所有從 <strong>Primary</strong> 的讀取。</p>
<p>為了支持複製操作，<strong>Primary</strong> 記錄其所有對其數據集的操作到他的 <a href="http://docs.mongodb.org/manual/core/replica-set-oplog/" target="_blank" rel="external">oplog</a> (operations log)。</p>
<p><strong>Secondaries</strong> 複製 <strong>Primary</strong> 的 oplog 到自己的數據集。</p>
<p><strong>Secondaries</strong> 的數據集印射 <strong>Primary</strong> 的數據集。</p>
<p>如果 <strong>Primary</strong> 不能用，Replica set 會選出一個 <strong>Secondary</strong> 成為 <strong>Primary</strong>。</p>
<p>預設情況下，clients 從 <strong>Primary</strong> 讀取，但是 clients 可以指定一個喜好的來發送讀取操作到 <strong>Secondary</strong>。從 <strong>Secondaries</strong> 讀取返回的資料可能不會反射 <strong>Primary</strong> 的狀態。</p>
<p><img src="http://docs.mongodb.org/manual/_images/replica-set-primary-with-two-secondaries.png" alt=""></p>
<p>你可以增加一個額外的 mongod 實例作為 replica set的 <a href="http://docs.mongodb.org/manual/core/replica-set-arbiter/" target="_blank" rel="external"><strong>Arbiter</strong> </a>(仲裁者)。它不用來維護數據集，只存在於選舉投票。</p>
<p>一個 <strong>Secondary</strong> 可能會經由一次選舉變為 <strong>Primary</strong>。</p>
<p><img src="http://docs.mongodb.org/manual/_images/replica-set-primary-with-secondary-and-arbiter.png" alt=""></p>
<p><img src="http://docs.mongodb.org/manual/_images/replica-set-trigger-election.png" alt=""></p>
<h2 id="ps:"><strong>ps:</strong></h2>
<ul>
<li><p>預設當作primary的server未經initiate()不會被設定為primary，無法在上面進行任何DB操作</p>
</li>
<li><p>作為secondary的server在arbiter未被建立前不會跟primary同步資料</p>
</li>
</ul>
<h2 id="MongoDB_Sharding"><a href="http://docs.mongodb.org/manual/sharding/" target="_blank" rel="external">MongoDB Sharding</a></h2>
<p><strong>Sharding</strong> 是將儲存資料跨不同機器的方法。</p>
<p>高查詢率會消耗 Server CPU 的能力，大型資料超過單一機器儲存的上限。</p>
<p>為了解決這些問題資料庫有兩種解決方式：</p>
<ul>
<li><strong>Vertical scaling</strong> : 垂直擴展，就是增加 CPU、增加 Ram 跟增加更多的儲存資源。</li>
<li><strong>Horizontal scaling</strong> : 水平擴展，使用 <strong>sharding</strong>(分片)機制，分割數據集使之可以跨越在多個 Server 中，或<strong>shards</strong>(碎片)。</li>
</ul>
<p>每個 <strong>shard</strong> 都是一個獨立的資料庫，很多個 <strong>shards</strong> 可以組成單一個邏輯資料庫。</p>
<p><img src="http://docs.mongodb.org/manual/_images/sharded-collection.png" alt=""></p>
<p>Sharding 減少了每個 Server 需要儲存的資料量。當 Cluster(集群)增長時，每個 <strong>Shard</strong> 儲存了更少的資料量。</p>
<p>舉例來說，一個資料庫擁有 <strong>1TB</strong> 的資料數據，分成4個 <strong>shards</strong> 來存，每個需管理 <strong>256GB</strong> 的資料量。</p>
<p>假如分配給40個 <strong>shards</strong>，每個 shard 只需管理 <strong>25GB</strong> 的資料而已。</p>
<h4 id="一個_MongoDB_的_Sharded_Cluster_由以下元件組成_:_shards，_query_routers_及_config_servers。">一個 MongoDB 的 Sharded Cluster 由以下元件組成 : <a href="http://docs.mongodb.org/manual/reference/glossary/#term-shard" target="_blank" rel="external">shards</a>， <a href="http://docs.mongodb.org/manual/reference/glossary/#term-mongos" target="_blank" rel="external">query routers</a> 及 <a href="http://docs.mongodb.org/manual/reference/glossary/#term-config-server" target="_blank" rel="external">config servers</a>。</h4>
<p><img src="http://docs.mongodb.org/manual/_images/sharded-cluster-production-architecture.png" alt=""></p>
<ul>
<li><p><strong>Shards</strong> : 用來儲存資料，為了提高可用性和資料的一致性，在 production 的<br>Sharded Cluster 每個 Shard 通常是一個 <a href="http://docs.mongodb.org/manual/reference/glossary/#term-replica-set" target="_blank" rel="external">Replica Set</a> (副本集)。</p>
</li>
<li><p><strong>Query Routers</strong> : 在 MongoDB 裡稱為 <a href="http://docs.mongodb.org/manual/reference/program/mongos/#bin.mongos" target="_blank" rel="external">mongos</a>，作為讓 client 端可以直接操作到對應的 shards的一個介面。一個 Sharded Cluster 可以擁有多個 Routers 來分擔 client 發過來的要求。</p>
</li>
<li><p><strong>Config servers</strong> : 儲存 cluster 的 metadata(用來描述資料屬性)</p>
</li>
</ul>
<h2 id="Data_Partitions(資料分割)">Data Partitions(資料分割)</h2>
<p>Sharding partitions a collection’s data by the shard key.</p>
<h4 id="Shard_Keys">Shard Keys</h4>
<p>要對一個collection做分片(shard)，需要選擇 <a href="http://docs.mongodb.org/manual/reference/glossary/#term-shard-key" target="_blank" rel="external"><strong>shard key</strong></a>。</p>
<p>MongoDB 由 shard key 將資料分割成許多的 <strong>chunks</strong> 平均分佈在 shards。依據 range based 和 hash based  不同種的 shard key，可以對資料做不同的儲存策略。</p>
<h4 id="Range_Based_Sharding">Range Based Sharding</h4>
<p><img src="http://docs.mongodb.org/manual/_images/sharding-range-based.png" alt=""></p>
<h4 id="Hash_Based_Sharding">Hash Based Sharding</h4>
<p><img src="http://docs.mongodb.org/manual/_images/sharding-hash-based.png" alt=""></p>
<h4 id="Customized_Data_Distribution_with_Tag_Aware_Sharding">Customized Data Distribution with <a href="http://docs.mongodb.org/manual/core/tag-aware-sharding/" target="_blank" rel="external">Tag Aware Sharding</a></h4>
<h2 id="維持分散資料平衡">維持分散資料平衡</h2>
<p>MongoDB使用兩個背景程式處理確保一個 blanced cluster：<strong>splitting</strong> &amp; <strong>balancer</strong>.</p>
<ul>
<li><h4 id="Splitting">Splitting</h4>
<p>Splitting，一個背景程式，確保 chunks 的成長不會太大。當一個 chunk 成長為指定的 chunk 大小(<a href="http://docs.mongodb.org/manual/core/sharding-chunk-splitting/#sharding-chunk-size" target="_blank" rel="external">specified chunk size</a>)時，會將 chunk 分成兩半。</p>
<p>MongoDB 預設的 chunk size 為 64 MB，你可以<a href="http://docs.mongodb.org/manual/tutorial/modify-chunk-size-in-sharded-cluster/" target="_blank" rel="external">增加或減少 chunks size</a>。</p>
<ol>
<li>比較小的 chunks，會讓資料更均勻的分佈，但是在資料搬移時花費更多的成本。</li>
<li>比較大的 chunks，無論是從網路的角度和在內部開銷方面，讓資料做比較少的搬移。但是這些效率可能會造成資料分佈不均的代價。</li>
<li>chunk 的大小，會影響每個 chunk 搬移(migrate)的最大文件數量。</li>
</ol>
</li>
</ul>
<p><img src="http://docs.mongodb.org/manual/_images/sharding-splitting.png" alt=""></p>
<ul>
<li><h4 id="Blancing">Blancing</h4>
<p>Blancer，一個背景程式，來管理 chunks 資料的搬移。Blancer 可以藉由 cluster 任何的 query routers 來被執行。</p>
<p><a href="http://docs.mongodb.org/manual/tutorial/manage-sharded-cluster-balancer/" target="_blank" rel="external">Manage Sharded Cluster Blancer </a></p>
</li>
</ul>
<p><img src="http://docs.mongodb.org/manual/_images/sharding-migrating.png" alt=""></p>
<h2 id="實作練習">實作練習</h2>
<p>使用 MongoDB 這樣做的優點，對延展(scaling)方便資料，並擁有一定的可靠度。當資料儲存空間快不足時，可以對其增加新的 shards，增加 cluster server 的儲存量。</p>
<p>已有三台可用的 server 機，利用這三台機器組成一個 Sharded Cluster Server。</p>
<p>目前規劃架構，每台機器各擁有一個 query router server (mongos) ，各一個 config server，這三台機器組成的 cluster server 擁有 3 個 cluster shards，每個 shard 都是一個副本集 (replica set)，分散在3台機器裡。</p>
<h2 id="movePrimary"><a href="http://docs.mongodb.org/manual/reference/command/movePrimary/" target="_blank" rel="external">movePrimary</a></h2>
<p><a href="http://duoyun.org/topic/519dac36e38d26a40a0b8b9c" target="_blank" rel="external">movePrimary命令的妙用</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/03/24/Mongodb-s-Replica-Set-Sharded-Cluster/" data-id="mooierjib7v4dx1m" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/03/24/Mongodb-s-Replica-Set-Sharded-Cluster/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB/">MongoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Replica-Set/">Replica Set</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Sharded-Cluster/">Sharded Cluster</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/學習筆記/">學習筆記</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Docker使用指南" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/03/07/Docker使用指南/" class="article-date">
  <time datetime="2015-03-06T16:29:55.000Z" itemprop="datePublished">Mar 7 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Docker-學習筆記/">Docker 學習筆記</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/07/Docker使用指南/">Docker使用指南</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="環境建置步驟">環境建置步驟</h4>
<ol>
<li><a href="http://www.vagrantup.com/downloads.html" target="_blank" rel="external">Vagrant下載頁</a>安裝Vagrant</li>
<li><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="external">Virtualbox下載頁</a>安裝<ul>
<li>VirtualBox platform packages</li>
<li>VirtualBox Extension Pack</li>
</ul>
</li>
<li>建立工作目錄<ul>
<li><code>$sudo mkdir docker-demo &amp;&amp; cd docker-demo</code></li>
</ul>
</li>
<li>產生Vagrantfile =&gt; ubuntu/trusty64: Ubuntu 14.04 LTS (Trusty Tahr) 64-bit<ul>
<li><code>$sudo vagrant init ubuntu/trusty64</code></li>
</ul>
</li>
<li>根據Vagrantfile啟動定義好的虛擬機<ul>
<li><code>$sudo vagrant up</code></li>
</ul>
</li>
<li>登入vagrant<ul>
<li><code>$sudo vagrant ssh</code></li>
</ul>
</li>
<li>登入vagrant<ul>
<li><code>$sudo vagrant exit</code></li>
</ul>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/03/07/Docker使用指南/" data-id="el0417978b5eatty" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/03/07/Docker使用指南/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/學習筆記/">學習筆記</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-MongoDB-The-Definitive-Guide讀書筆記" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/02/26/MongoDB-The-Definitive-Guide讀書筆記/" class="article-date">
  <time datetime="2015-02-26T08:04:23.000Z" itemprop="datePublished">Feb 26 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MongoDB-學習筆記/">MongoDB 學習筆記</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/02/26/MongoDB-The-Definitive-Guide讀書筆記/">MongoDB The Definitive Guide讀書筆記</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>紀錄讀<strong><a href="http://it-ebooks.info/book/2333/" target="_blank" rel="external">MongoDB: The Definitive Guide</a></strong>這本書時，自己認為的重點</p>
<h4 id="DataBase名稱可以用任何_UTF-8_字串，並且符合以下規則">DataBase名稱可以用任何 UTF-8 字串，並且符合以下規則</h4>
<ul>
<li>空字串不是有效名稱</li>
<li>不能包含/, \, ., “, *, &lt;, &gt;, :, |, ?, $, (a single space), or \0 (the null character)</li>
<li>名稱有區分大小寫，即使在不分大小寫的檔案系統裡</li>
<li>最大限制 64 bytes</li>
</ul>
<h4 id="預先留存的DataBase，含有特殊的含義">預先留存的DataBase，含有特殊的含義</h4>
<ul>
<li>admin : 代表root DataBase，如果一個user被加入此DB，該user自動繼承允許連到其他DB</li>
<li>local : 這個DB永遠不會被replicated，慣用於儲存any collections that should be local to a single server</li>
<li>config : 用來sharded setup，儲存shard的資訊</li>
</ul>
<h4 id="mongod預設儲存的資料路徑_/data/db/">mongod預設儲存的資料路徑 <em>/data/db/</em></h4>
<h4 id="預設的port=27017">預設的port=27017</h4>
<h4 id="可以用_—httpinterface_這個參數設定一個簡單的http_interface_他的port指定為主要port多1000。以預設port為例，可以連到http://localhost:28017觀看">可以用 —httpinterface 這個參數設定一個簡單的http interface 他的port指定為主要port多1000。以預設port為例，可以連到<a href="http://localhost:28017觀看" target="_blank" rel="external">http://localhost:28017觀看</a></h4>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/02/26/MongoDB-The-Definitive-Guide讀書筆記/" data-id="tk5sk3s4eqo29wsj" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/02/26/MongoDB-The-Definitive-Guide讀書筆記/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB/">MongoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB-The-Definitive-Guide/">MongoDB The Definitive Guide</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/學習筆記/">學習筆記</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-備份-還原MongoDB資料庫" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/02/24/備份-還原MongoDB資料庫/" class="article-date">
  <time datetime="2015-02-24T01:56:30.000Z" itemprop="datePublished">Feb 24 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MongoDB-學習筆記/">MongoDB 學習筆記</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/02/24/備份-還原MongoDB資料庫/">備份&amp;還原MongoDB資料庫</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Command_Line_Tool">Command Line Tool</h2>
<h4 id="備份資料">備份資料</h4>
<pre><code>mongodump
</code></pre><p>範例:<br>將遠端Sever上的MongoDB資料備份 <em>Bet</em> 到本地端 <em>./tmp/Backup</em> 位置<br><code>$mongodump --host 172.16.18.65:27017 --db Bet --out ./tmp/Backup</code></p>
<h4 id="還原資料">還原資料</h4>
<pre><code>mongorestore
</code></pre><p>範例:<br>將本地端 <em>./tmp/Backup</em> 位置的MongoDB備份資料還原到 <em>localhost:30001</em><br><code>$mongorestore --host localhost:30001 ./tmp/Backup/</code></p>
<h4 id="經測試可以將single_instance_server的資料dump出來，restore到cluster_server_的_shards">經測試可以將single instance server的資料dump出來，restore到cluster server 的 shards</h4>
<h4 id="PS:version_3-0-1_測試mongorestore_無法透過mogos上使用">PS:version 3.0.1 測試mongorestore 無法透過mogos上使用</h4>
<p>在replica set 上的 primary上可以成功，未initiate的不能使用</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/02/24/備份-還原MongoDB資料庫/" data-id="06jsbjss2ub7h7ry" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/02/24/備份-還原MongoDB資料庫/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB/">MongoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongodump/">mongodump</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongorestore/">mongorestore</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/學習筆記/">學習筆記</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-部署Mongodb-Sharded-Cluster" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/02/16/部署Mongodb-Sharded-Cluster/" class="article-date">
  <time datetime="2015-02-16T03:38:45.000Z" itemprop="datePublished">Feb 16 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MongoDB-學習筆記/">MongoDB 學習筆記</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/02/16/部署Mongodb-Sharded-Cluster/">部署Mongodb Sharded Cluster</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="_"> </h4>
<pre><code>可擴展的MongoDB解決方案
</code></pre><p>官方文件:<a href="http://docs.mongodb.org/manual/tutorial/deploy-shard-cluster/" target="_blank" rel="external">http://docs.mongodb.org/manual/tutorial/deploy-shard-cluster/</a></p>
<h4 id="本地端部署_MongoDB_Shard_Cluster">本地端部署 MongoDB Shard Cluster</h4>
<p>( 2 Router Server, 3 Config Server, 3 Shard Server )的shell script</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/bin/bash</span></div><div class="line"> </div><div class="line"><span class="comment">#參考 http://docs.mongodb.org/manual/tutorial/deploy-shard-cluster/</span></div><div class="line"> </div><div class="line"><span class="comment">##################################################################################################################</span></div><div class="line"><span class="comment"># WARNING</span></div><div class="line"><span class="comment"># Sharding and “localhost” Addresses</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># If you use either “localhost” or 127.0.0.1 as the hostname portion of any host identifier, </span></div><div class="line"><span class="comment"># for example as the host argument to addShard or the value to the --configdb run time option, </span></div><div class="line"><span class="comment"># then you must use “localhost” or 127.0.0.1 for all host settings for any MongoDB instances in the cluster. </span></div><div class="line"><span class="comment"># If you mix localhost addresses and remote host address, MongoDB will error.</span></div><div class="line"><span class="comment">##################################################################################################################</span></div><div class="line"> </div><div class="line">_redColor=<span class="string">'\033[0;31m'</span></div><div class="line">_yellowColor=<span class="string">'\033[1;33m'</span></div><div class="line">_greenColor=<span class="string">'\033[0;32m'</span></div><div class="line">_noColor=<span class="string">'\033[0m'</span> <span class="comment"># No Color</span></div><div class="line"> </div><div class="line"><span class="comment">#設定執行目錄</span></div><div class="line">DB_ROOT_PATH=~/data</div><div class="line"> </div><div class="line"><span class="comment">#Shard Server設定</span></div><div class="line">SHARD_PATH_1=<span class="variable">$DB_ROOT_PATH</span><span class="string">'/shard1'</span></div><div class="line">SHARD_PORT_1=<span class="number">10001</span></div><div class="line"> </div><div class="line">SHARD_PATH_2=<span class="variable">$DB_ROOT_PATH</span><span class="string">'/shard2'</span></div><div class="line">SHARD_PORT_2=<span class="number">10002</span></div><div class="line"> </div><div class="line">SHARD_PATH_3=<span class="variable">$DB_ROOT_PATH</span><span class="string">'/shard3'</span></div><div class="line">SHARD_PORT_3=<span class="number">10003</span></div><div class="line"> </div><div class="line"><span class="comment">#Config Server設定</span></div><div class="line">CONFIG_PATH_1=<span class="variable">$DB_ROOT_PATH</span><span class="string">'/config1'</span></div><div class="line">CONFIG_PORT_1=<span class="number">20001</span></div><div class="line"> </div><div class="line">CONFIG_PATH_2=<span class="variable">$DB_ROOT_PATH</span><span class="string">'/config2'</span></div><div class="line">CONFIG_PORT_2=<span class="number">20002</span></div><div class="line"> </div><div class="line">CONFIG_PATH_3=<span class="variable">$DB_ROOT_PATH</span><span class="string">'/config3'</span></div><div class="line">CONFIG_PORT_3=<span class="number">20003</span></div><div class="line"> </div><div class="line"><span class="comment">#Router Server設定</span></div><div class="line">ROUTER_PORT_1=<span class="number">30001</span></div><div class="line">ROUTER_PORT_2=<span class="number">30002</span></div><div class="line"> </div><div class="line"> </div><div class="line"><span class="comment"># echo "kill 舊的 process"</span></div><div class="line"><span class="comment"># kill $(ps aux | grep mongo | awk -F" " '{print $2}')</span></div><div class="line"> </div><div class="line"> </div><div class="line"> </div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>開始本地部署 mongodb sharded cluster in localhost...<span class="variable">${_noColor}</span>"</span></div><div class="line"> </div><div class="line"><span class="comment">#清空DB資料</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>清空DB資料...<span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; <span class="variable">${DB_ROOT_PATH}</span><span class="variable">${_noColor}</span>"</span></div><div class="line">rm -rf <span class="variable">$DB_ROOT_PATH</span></div><div class="line"> </div><div class="line"><span class="comment">#建立DB目錄</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>建立DB目錄...<span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; <span class="variable">${SHARD_PATH_1}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; <span class="variable">${SHARD_PATH_2}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; <span class="variable">${SHARD_PATH_3}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; <span class="variable">${CONFIG_PATH_1}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; <span class="variable">${CONFIG_PATH_2}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; <span class="variable">${CONFIG_PATH_3}</span><span class="variable">${_noColor}</span>"</span></div><div class="line">mkdir -p <span class="variable">$SHARD_PATH_1</span> <span class="variable">$SHARD_PATH_2</span> <span class="variable">$SHARD_PATH_3</span> <span class="variable">$CONFIG_PATH_1</span> <span class="variable">$CONFIG_PATH_2</span> <span class="variable">$CONFIG_PATH_3</span></div><div class="line"> </div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>Set 3 Config Server...<span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; localhost:<span class="variable">${CONFIG_PORT_1}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; localhost:<span class="variable">${CONFIG_PORT_2}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; localhost:<span class="variable">${CONFIG_PORT_3}</span><span class="variable">${_noColor}</span>"</span></div><div class="line">mongod --dbpath <span class="variable">$CONFIG_PATH_1</span> --port <span class="variable">$CONFIG_PORT_1</span> --fork --logpath <span class="variable">$DB_ROOT_PATH</span><span class="string">'/config1.log'</span></div><div class="line">mongod --dbpath <span class="variable">$CONFIG_PATH_2</span> --port <span class="variable">$CONFIG_PORT_2</span> --fork --logpath <span class="variable">$DB_ROOT_PATH</span><span class="string">'/config2.log'</span></div><div class="line">mongod --dbpath <span class="variable">$CONFIG_PATH_3</span> --port <span class="variable">$CONFIG_PORT_3</span> --fork --logpath <span class="variable">$DB_ROOT_PATH</span><span class="string">'/config3.log'</span></div><div class="line"><span class="comment">#講解 --fork http://chenzhou123520.iteye.com/blog/1634676</span></div><div class="line"> </div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>Set 2 Router Server...<span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; localhost:<span class="variable">${ROUTER_PORT_1}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; localhost:<span class="variable">${ROUTER_PORT_2}</span><span class="variable">${_noColor}</span>"</span></div><div class="line">mongos --configdb localhost:<span class="variable">$CONFIG_PORT_1</span>\</div><div class="line">,localhost:<span class="variable">$CONFIG_PORT_2</span>,\</div><div class="line">localhost:<span class="variable">$CONFIG_PORT_3</span> \</div><div class="line">--port <span class="variable">$ROUTER_PORT_1</span> --fork --logpath <span class="variable">$DB_ROOT_PATH</span><span class="string">'/router1.log'</span></div><div class="line"> </div><div class="line">mongos --configdb localhost:<span class="variable">$CONFIG_PORT_1</span>\</div><div class="line">,localhost:<span class="variable">$CONFIG_PORT_2</span>,\</div><div class="line">localhost:<span class="variable">$CONFIG_PORT_3</span> \</div><div class="line">--port <span class="variable">$ROUTER_PORT_2</span> --fork --logpath <span class="variable">$DB_ROOT_PATH</span><span class="string">'/router2.log'</span></div><div class="line"> </div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>Set 3 Shard Server...<span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; localhost:<span class="variable">${SHARD_PORT_1}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; localhost:<span class="variable">${SHARD_PORT_2}</span><span class="variable">${_noColor}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_yellowColor}</span>  -&gt; localhost:<span class="variable">${SHARD_PORT_3}</span><span class="variable">${_noColor}</span>"</span></div><div class="line">mongod --dbpath <span class="variable">$SHARD_PATH_1</span> --port <span class="variable">$SHARD_PORT_1</span> --nojournal --fork --logpath <span class="variable">$DB_ROOT_PATH</span><span class="string">'/shard1.log'</span></div><div class="line">mongod --dbpath <span class="variable">$SHARD_PATH_2</span> --port <span class="variable">$SHARD_PORT_2</span> --nojournal --fork --logpath <span class="variable">$DB_ROOT_PATH</span><span class="string">'/shard2.log'</span></div><div class="line">mongod --dbpath <span class="variable">$SHARD_PATH_3</span> --port <span class="variable">$SHARD_PORT_3</span> --nojournal --fork --logpath <span class="variable">$DB_ROOT_PATH</span><span class="string">'/shard3.log'</span></div><div class="line"><span class="comment">#講解 --nojournal http://blog.chinaunix.net/uid-15795819-id-3381684.html</span></div><div class="line"> </div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>Add Shard Node...<span class="variable">${_noColor}</span>"</span></div><div class="line">mongo localhost:<span class="variable">$ROUTER_PORT_1</span> --eval <span class="string">'printjson(sh.addShard("localhost:'</span><span class="variable">$SHARD_PORT_1</span><span class="string">'"))'</span></div><div class="line">mongo localhost:<span class="variable">$ROUTER_PORT_1</span> --eval <span class="string">'printjson(sh.addShard("localhost:'</span><span class="variable">$SHARD_PORT_2</span><span class="string">'"))'</span></div><div class="line">mongo localhost:<span class="variable">$ROUTER_PORT_1</span> --eval <span class="string">'printjson(sh.addShard("localhost:'</span><span class="variable">$SHARD_PORT_3</span><span class="string">'"))'</span></div><div class="line"><span class="comment"># echo -e "${_greenColor}### Setup Finished!!! ###${_noColor}"</span></div><div class="line"> </div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>Enable Sharding for a Database...<span class="variable">${_noColor}</span>"</span></div><div class="line">mongo localhost:<span class="variable">$ROUTER_PORT_1</span> --eval <span class="string">'printjson(sh.enableSharding("Cluster_DB"))'</span></div><div class="line"> </div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>Enable Sharding for a Collection...<span class="variable">${_noColor}</span>"</span></div><div class="line">mongo localhost:<span class="variable">$ROUTER_PORT_1</span> --eval <span class="string">'printjson(sh.shardCollection("Cluster_DB.users", {"_id": "hashed"} ))'</span></div><div class="line"> </div><div class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"<span class="variable">${_greenColor}</span>MongoDB Shell<span class="variable">${_noColor}</span>"</span></div><div class="line">mongo localhost:<span class="variable">$ROUTER_PORT_1</span></div></pre></td></tr></table></figure>

<p>Gist:<a href="https://gist.github.com/miles990/f06d123a1afc1aa86c95" target="_blank" rel="external">https://gist.github.com/miles990/f06d123a1afc1aa86c95</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/02/16/部署Mongodb-Sharded-Cluster/" data-id="mg2th7qpi2ohuj3w" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/02/16/部署Mongodb-Sharded-Cluster/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB/">MongoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Sharded-Cluster/">Sharded Cluster</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/學習筆記/">學習筆記</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Git" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/01/20/Git/" class="article-date">
  <time datetime="2015-01-19T16:01:55.000Z" itemprop="datePublished">Jan 20 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Git-學習筆記/">Git 學習筆記</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/01/20/Git/">Git</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="參考:_http://git-scm-com/book/zh-tw/v1/">參考: <a href="http://git-scm.com/book/zh-tw/v1/" target="_blank" rel="external">http://git-scm.com/book/zh-tw/v1/</a></h4>
<h2 id="Git_有三種檔案狀態的表達方式">Git 有三種檔案狀態的表達方式</h2>
<ul>
<li>committed(已提交)</li>
<li>modified(已修改)</li>
<li>staged(暫存)</li>
</ul>
<h2 id="常用指令">常用指令</h2>
<ul>
<li><p><strong>初始化 git 儲存庫:</strong> 切換到欲使用版本控管的目錄下，執行以下命令<br><code>$git init</code><br>此動作會在目錄下建立名為 <strong>.git</strong> 的子資料夾，此資料夾下存放 git 相關的記錄檔案</p>
</li>
<li><p><strong>將目標 &lt;檔案&gt; or &lt;目錄&gt; 加到準備提交的狀態:</strong> (準備commit，尚未送出)<br><code>$git add &lt;檔案&gt;</code> or <code>$git add &lt;目錄&gt;</code></p>
</li>
<li><p><strong>複製現有 &lt;儲存庫(reposity)&gt; </strong><br><code>$git clone &lt;repo&gt;</code></p>
</li>
<li><p><strong>檢視檔案的狀態</strong><br><code>$git status</code></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/01/20/Git/" data-id="0o2fkntniq9kihis" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/01/20/Git/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LoopBack簡介" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/01/06/LoopBack簡介/" class="article-date">
  <time datetime="2015-01-06T09:35:57.000Z" itemprop="datePublished">Jan 6 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Node-js-Framework/">Node.js Framework</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/01/06/LoopBack簡介/">LoopBack簡介</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="方便建立_API_和連接後端資料的_Node-js_Framework">方便建立 API 和連接後端資料的 Node.js Framework</h4>
<p><img src="http://img.phperz.com/data/img/20140723/1406090751_5056.png" alt=""></p>
<h1 id="關於"><code>關於</code></h1>
<h4 id="LoopBack_是一個高度擴展、開源的_Node-js_框架">LoopBack 是一個高度擴展、開源的 Node.js 框架</h4>
<ul>
<li>快速建立動態的 <strong>end-to-end REST APIs</strong></li>
<li>連接設備跟瀏覽器的數據跟服務</li>
<li>採用 <strong>Android</strong>，<strong>IOS</strong> 和 <strong>AngularJS</strong> 軟件開發工具包能夠輕鬆地創建客戶端應用程序</li>
<li>附加組件含，推播、檔案管理、第三方登入及地理定位</li>
<li>使用 <strong>StrongLoop Arc</strong> 做到可視化編輯，部署和監控 LoopBack apps</li>
<li><strong>LoopBack API gateway</strong> 作為使用 API 的顧客 (clients) 和 API 提供者的中間人達到外部化、安全及管理的 APIs</li>
<li>可運行在本地或雲端</li>
</ul>
<h1 id="特點"><code>特點</code></h1>
<ul>
<li><h4 id="快速建立_model_及創建_REST_的_API">快速建立 model 及創建 REST 的 API</h4>
<ul>
<li>簡單易用的 <strong>CLI</strong> 精靈 </li>
<li>如果你有 schema 的話根據他創建 models</li>
<li>如果沒有則建立動態 models</li>
<li>內置的 API 瀏覽器</li>
</ul>
</li>
<li><h4 id="簡易的認證跟授權設置">簡易的認證跟授權設置</h4>
<ul>
<li>內置基於角色的存取控制</li>
<li>oAuth 使用者跟註冊模型</li>
<li>使用 CLI 跟 JSON 格式增加個人設置策略</li>
<li>瀏覽器支援 ( JSONP 和 CORS )</li>
</ul>
</li>
<li><h4 id="支持模型關係">支持模型關係</h4>
<ul>
<li>定義 hasMany，belongsTo，hasAndBelongsToMany 關係</li>
<li>自動生成相應關係的 REST 端點</li>
</ul>
</li>
<li><h4 id="MIT_開源許可">MIT 開源許可</h4>
<ul>
<li>雙許可：MIT 開源許可或 StrongLoop 許可</li>
</ul>
</li>
<li><h4 id="連接後端數據儲存支援">連接後端數據儲存支援</h4>
<ul>
<li>MySQL, Oracle, MongoDB, Postgres 和其他</li>
<li>其他 REST 服務</li>
<li>Oracle, MySQL, PostgreSQL 和 SQL Server 探索 APIs</li>
</ul>
</li>
<li><h4 id="即席查詢支援">即席查詢支援</h4>
<ul>
<li>裝置上的動態查詢，瀏覽器跟 Server</li>
<li>針對關係資料庫支援 NoSQL 風格的查詢</li>
</ul>
</li>
</ul>
<h1 id="開始使用"><code>開始使用</code></h1>
<h4 id="安裝">安裝</h4>
<p>假設你已經安裝 Node.js<br>透過 npm 安裝 LoopBack 應用的 StrongLoop 工具</p>
<h2 id="$_npm_install_-g_strongloop"><code>$ npm install -g strongloop</code></h2>
<h4 id="建立_app">建立 app</h4>
<p>建立一個 “Hello World” LoopBack app</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://miles990.github.io/2015/01/06/LoopBack簡介/" data-id="fri92oowsqg8khs5" class="article-share-link">Share</a>
      
        <a href="http://miles990.github.io/2015/01/06/LoopBack簡介/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/framework/">framework</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/loopback/">loopback</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/學習筆記/">學習筆記</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker-學習筆記/">Docker 學習筆記</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git-學習筆記/">Git 學習筆記</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MongoDB-學習筆記/">MongoDB 學習筆記</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js-Framework/">Node.js Framework</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js-學習筆記/">Node.js 學習筆記</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/心情/">心情</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/深入淺出Node-js讀書心得/">深入淺出Node.js讀書心得</a><span class="category-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/">MongoDB</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB-The-Definitive-Guide/">MongoDB The Definitive Guide</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Replica-Set/">Replica Set</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sharded-Cluster/">Sharded Cluster</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/framework/">framework</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/loopback/">loopback</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodump/">mongodump</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongorestore/">mongorestore</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/學習筆記/">學習筆記</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/心情/">心情</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深入淺出Node-js讀書心得-一/">深入淺出Node.js讀書心得(一)</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深入淺出Node-js讀書心得-二/">深入淺出Node.js讀書心得(二)</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/讀書心得/">讀書心得</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/讀書會/">讀書會</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/04/23/深入淺出Node-js讀書心得-二/">深入淺出Node.js讀書心得(二)</a>
          </li>
        
          <li>
            <a href="/2015/04/23/深入淺出Node-js讀書心得-ㄧ/">深入淺出Node.js讀書心得(ㄧ)</a>
          </li>
        
          <li>
            <a href="/2015/04/18/Node-js讀書會/">Node.js讀書會</a>
          </li>
        
          <li>
            <a href="/2015/03/24/Mongodb-s-Replica-Set-Sharded-Cluster/">Mongodb&#39;s Replica Set &amp; Sharded Cluster</a>
          </li>
        
          <li>
            <a href="/2015/03/07/Docker使用指南/">Docker使用指南</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Alex Lee<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'miles990';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/script.js" type="text/javascript"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58099799-1', 'auto');
  ga('send', 'pageview');

</script>

  </div>
</body>
</html>